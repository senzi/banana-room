# banana-room äº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰

## é¡¹ç›®åç§°

**banana-room**

## ç®€è¦æè¿°

A minimalist simulation that starts with equal monkeys and ends with unequal bananas. Rules only. No opinions.

---

## é¡¹ç›®ç›®æ ‡

æ„å»ºä¸€ä¸ªå¯åœ¨ç§»åŠ¨ç«¯æµç•…è¿è¡Œçš„ã€åŸºäº Vue + Vite æ„å»ºçš„ Web æ¨¡æ‹Ÿå™¨ï¼Œç”¨äºæ¼”ç¤ºéšæœºäº¤æ¢è§„åˆ™ä¸‹çš„éå¯¹ç§°ç»“æœæ¼”åŒ–ã€‚

æ¨¡æ‹Ÿé€»è¾‘æºè‡ª tombkeeper çš„å¾®åšæ–‡ç« ã€Šå³ä¾¿èµ·è·‘æ—¶å®Œå…¨ä¸€æ ·ï¼Œæœ€ç»ˆä¹Ÿè¿˜æ˜¯ä¼šä¸åŒã€‹ï¼Œé€šè¿‡å¯è§†åŒ–æ‰‹æ®µè¡¨ç° 20 åªçŒ´å­ã€7300 å¤©çš„é¦™è•‰é‡åˆ†é…è¿‡ç¨‹ã€‚

ä¸åšç»“è®ºï¼Œä¸åŠ ç‚¹è¯„ï¼Œå¼ºè°ƒâ€œè§„åˆ™ â†’ è¿‡ç¨‹ â†’ ç»“æœâ€çš„è§‚å¯Ÿä½“éªŒã€‚

---

## æ¶æ„æŠ€æœ¯æ ˆ

- Vite + Vue 3 + Composition API
- ECharts æˆ– Chart.jsï¼ˆæŸ±çŠ¶å›¾ï¼‰
- Piniaï¼ˆçŠ¶æ€ç®¡ç†ï¼‰
- CSS åŠ¨ç”»æˆ– class æ§åˆ¶ï¼ˆå®ç°é«˜äº®é—ªçƒï¼‰
- æ”¯æŒéƒ¨ç½²åˆ° Cloudflare Functions + Pages

---

## é¡µé¢ç»“æ„æ¦‚è§ˆ

### é¡µé¢è·¯å¾„

`/`

### é¡µé¢æ¨¡å—åˆ’åˆ†

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸµ TitleSection             â”‚ // é¡¹ç›®æ ‡é¢˜ + å±•å¼€è§„åˆ™è¯´æ˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“„ RulesBox (å¯æŠ˜å )         â”‚ // å±•ç¤ºæ–‡å­—æè¿°çš„è§„åˆ™
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š ChartPanel               â”‚ // å½“å‰ banana åˆ†å¸ƒæŸ±çŠ¶å›¾ + é—ªçƒåŠ¨ç”»
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ® ControlPanel             â”‚ // æ§åˆ¶æ’­æ”¾ã€é€Ÿç‡ã€é‡ç½®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ˆ SummaryPanel             â”‚ // æœ€ç»ˆç»“æœå±•ç¤ºï¼ˆä¸è§£é‡Šï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é¡µé¢äº¤äº’è¯´æ˜

### TitleSection

- å±•ç¤ºæ–‡å­—ï¼š
  - ä¸»æ ‡é¢˜ï¼š`è¿™æ˜¯ä¸€ä¸ªå…³äºçŒ´å­å’Œé¦™è•‰çš„æ•…äº‹`
  - å­æ ‡é¢˜æŒ‰é’®ï¼š`â–½ å±•å¼€è§„åˆ™`
- ç‚¹å‡»å±•å¼€åï¼Œæ˜¾ç¤º RulesBox

### RulesBox

> å±•ç¤ºå›ºå®šçš„è§„åˆ™è¯´æ˜ï¼ˆæ–‡å­—å†…å®¹ï¼‰ï¼š

```text
æœ‰ 20 åªçŒ´å­ï¼Œæ¯åªçŒ´å­æœ€åˆæ‹¥æœ‰ 20 æ ¹é¦™è•‰ã€‚
æ¯å¤©ï¼Œæ¯åªçŒ´å­ä¼šéšæœºèµ å‡ºä¸€æ ¹é¦™è•‰ï¼ˆè‹¥å®ƒè¿˜æœ‰ï¼‰ã€‚
æ¥æ”¶è€…éšæœºï¼Œä¸èƒ½æ˜¯è‡ªå·±ã€‚
èµ å‡ºæ˜¯ä¹‰åŠ¡ï¼Œæ¥æ”¶æ˜¯æœºä¼šã€‚ä¸èƒ½æ¬ å€ºã€‚
ä»¥ä¸Šæ“ä½œæŒç»­ 20 å¹´ï¼ˆå…± 7300 å¤©ï¼‰ã€‚
```

### ChartPanel

- å±•ç¤ºæ¯åªçŒ´å­çš„å½“å‰é¦™è•‰æ•°é‡ï¼ˆæŸ±çŠ¶å›¾ï¼‰
- æ¯è½®æ’­æ”¾æ—¶ï¼šé«˜äº®èµ å‡ºè€…ï¼ˆè“è‰²é—ªçƒï¼‰ä¸æ¥æ”¶è€…ï¼ˆé»„è‰²é—ªçƒï¼‰
- é»˜è®¤æ¯è½®é—´éš”ï¼š500msï¼Œå¯è°ƒæ•´

### ControlPanel

- æ§ä»¶è¯´æ˜ï¼š
  - â–¶ï¸ å¼€å§‹ / â¸ï¸ æš‚åœ
  - ğŸ” é‡ç½®æ¨¡æ‹Ÿ
  - ğŸ¢-ğŸ‡ é€Ÿç‡è°ƒèŠ‚æ»‘æ¡ï¼ˆ100ms \~ 1000msï¼‰
- æ¯æ¬¡å¼€å§‹æ¨¡æ‹Ÿä¼šé¢„è®¡ç®—æ•´ä¸ª historyï¼ˆ7300 è½®ï¼‰ï¼Œç”¨äºå‰ç«¯å›æ”¾

### SummaryPanelï¼ˆæœ€ç»ˆç»“æœå±•ç¤ºï¼‰

- æ’­æ”¾ç»“æŸåæ˜¾ç¤ºï¼š
  - æœ€å¤§å€¼ / æœ€å°å€¼
  - æœ€å¤§ vs æœ€å°çš„æŸ±çŠ¶å›¾æ˜¾ç¤º
  - æ— ä»»ä½•ç»“è®ºæ€§è¯­è¨€
  - ç¤ºä¾‹æ–‡æ¡ˆï¼š
    > è¿™å°±æ˜¯ 20 å¹´åã€‚ æœ€å¤§ï¼š61 æ ¹é¦™è•‰ï¼Œæœ€å°ï¼š2 æ ¹ã€‚

---

## æ•°æ®ç»“æ„ä¸çŠ¶æ€ç®¡ç†

```ts
interface SimulationState {
  apes: number[];          // å½“å‰é¦™è•‰æ•°ï¼ˆç”¨äºç»˜å›¾ï¼‰
  history: number[][];     // æ‰€æœ‰å¤©çš„é¦™è•‰çŠ¶æ€å¿«ç…§
  highlight: {             // å½“å‰è½®æ¬¡é«˜äº®ä¿¡æ¯
    from: number;
    to: number;
  } | null;
  currentDay: number;      // æ’­æ”¾è¿›åº¦
  running: boolean;
  speed: number;           // æ’­æ”¾é€Ÿåº¦ï¼ˆms/è½®ï¼‰
}
```

> å»ºè®®ä½¿ç”¨ Pinia ç»Ÿä¸€ç®¡ç†ï¼›æˆ–ç”¨ provide/inject ç®¡ç†å±€éƒ¨çŠ¶æ€ã€‚

---

## æ¨¡æ‹Ÿé€»è¾‘è¯´æ˜

### åˆå§‹çŠ¶æ€

- `apes = Array(20).fill(20)`

### æ¯å¤©åˆ†é…è§„åˆ™

- æ¯åªçŒ´å­ï¼ˆå¦‚ apes[i] > 0ï¼‰ï¼š
  - å‡å» 1 æ ¹é¦™è•‰
  - éšæœºé€‰æ‹©å¦ä¸€åªçŒ´å­ï¼ˆâ‰  iï¼‰ï¼ŒåŠ  1 æ ¹é¦™è•‰

### æ¨¡æ‹Ÿè¿è¡Œï¼š

```ts
function simulate(years = 20, days = 365) => number[][] {
  const result = []
  const apes = Array(20).fill(20)

  for (let i = 0; i < years * days; i++) {
    const dayHighlight = []
    for (let j = 0; j < 20; j++) {
      if (apes[j] > 0) {
        apes[j]--
        const to = randomOther(20, j)
        apes[to]++
        dayHighlight.push({ from: j, to })
      }
    }
    result.push([...apes])
    // å¯é€‰ï¼šè®°å½• highlight çš„æ˜ å°„è¡¨ä¾›æ’­æ”¾æ—¶å‚è€ƒ
  }

  return result
}
```

---

## UI/UX æ³¨æ„äº‹é¡¹

- ç§»åŠ¨ç«¯ä¸ºä¸»ï¼Œå›¾è¡¨åº”æ”¯æŒæ¨ªå‘æ»šåŠ¨ï¼ˆoverflow-xï¼‰
- æŸ±çŠ¶å›¾é¢œè‰²æŸ”å’Œï¼Œéé«˜äº®çŠ¶æ€ç»Ÿä¸€æµ…ç°è‰²
- é«˜äº®é¢œè‰²ï¼š
  - èµ å‡ºè€…ï¼šè“è‰²
  - æ¥æ”¶è€…ï¼šé»„è‰²
- æ‰€æœ‰æ–‡å­—æè¿°é¿å…ç»“è®ºæ€§è¯„åˆ¤ï¼Œä»…é™ˆè¿°äº‹å®å’Œè§„åˆ™
- é€Ÿåº¦è°ƒèŠ‚å»ºè®®åˆ†ä¸ºï¼šæ…¢ï¼ˆ1000msï¼‰/ ä¸­ï¼ˆ500msï¼‰/ å¿«ï¼ˆ100msï¼‰ä¸‰æ¡£
- åˆå§‹è¿›å…¥é¡µé¢ä¸ºé™æ­¢çŠ¶æ€ï¼Œç”±ç”¨æˆ·æ‰‹åŠ¨å¯åŠ¨æ¨¡æ‹Ÿ

---


